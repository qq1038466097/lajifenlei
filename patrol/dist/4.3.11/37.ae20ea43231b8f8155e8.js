webpackJsonp([37],{816:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),u=r(n),s=a(209),d=r(s),c=a(147),i=r(c),o=a(342),l=r(o);a(210);var p=a(319),f=a(60);t.default={namespace:"deviceList",state:{data:[],paginationG:{},searchList:{},pageindex:1,pagesize:10,modalAdd:!1,selectedRowKeys:[]},subscriptions:{setup:function(e){var t=e.dispatch;e.history.listen(function(e){"/deviceList"===e.pathname&&(t({type:"clearData"}),t({type:"queryHistory"}))})}},effects:{queryHistory:i.default.mark(function e(t,a){var r,n,u=(a.call,a.put),s=a.select;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(0,l.default)(t),e.next=3,s(function(e){return e.deviceList});case 3:return r=e.sent,n=r.searchList,e.next=7,u({type:"queryRule",payload:{}});case 7:case"end":return e.stop()}},e,this)}),deviceSave:i.default.mark(function e(t,a){var r,n,u=t.payload,s=t.address,d=a.call,c=a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(p.deviceAdd,u);case 2:if(r=e.sent,200!=r.code){e.next=8;break}return n={},n.keyWord=s,e.next=8,c({type:"queryList",payload:n,datas:r.data});case 8:case"end":return e.stop()}},e,this)}),queryList:i.default.mark(function e(t,a){var r,n,u,s,d,c=t.payload,o=t.datas,l=a.call,y=a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(p.proLists,c);case 2:if(r=e.sent,200!=r.code){e.next=18;break}if(!(null==r.data||0==r.data.data.length||r.data.data.length>1)){e.next=8;break}return e.abrupt("return",!1);case 8:return n=r.data.data[0],u=n,s={},d=[],s.equipmentId=o.equId,s.bindId=f.userIds,d.push(s),u.bindRels=d,e.next=18,y({type:"buildDevice",payload:u});case 18:case"end":return e.stop()}},e,this)}),buildDevice:i.default.mark(function e(t,a){var r,n=t.payload,u=a.call;a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(p.proAdd,n);case 2:r=e.sent,r.code;case 4:case"end":return e.stop()}},e,this)}),dotDelete:i.default.mark(function e(t,a){var r,n,u=t.payload,s=t.searchList,c=a.call,o=a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(p.deviceDel,u);case 2:if(r=e.sent,200!=r.code){e.next=8;break}return d.default.success("\u5220\u9664\u6210\u529f!"),n=s,e.next=8,o({type:"queryRule",payload:n});case 8:case"end":return e.stop()}},e,this)}),dotDeleteMore:i.default.mark(function e(t,a){var r,n=t.payload,u=a.call;a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(p.deviceDel,n);case 2:r=e.sent;case 3:case"end":return e.stop()}},e,this)}),queryRule:i.default.mark(function e(t,a){var r,n,u,s,d,c,o=t.payload,l=a.call,f=a.put;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(p.deviceLisks,o);case 2:if(r=e.sent,200!=r.code){e.next=24;break}if(null!=r.data.data&&0!=r.data.data.length){e.next=14;break}return n={},n.total=0,n.pageSize=0,n.current=0,n.pageCount=0,e.next=12,f({type:"querySuccess",payload:[],page:n});case 12:e.next=24;break;case 14:for(u={},u.total=r.data.totalCount,u.pageSize=r.data.pageSize,u.current=r.data.currentIndex,s=Math.ceil(r.data.totalCount/r.data.pageSize),u.pageCount=s,d=r.data.data,c=0;c<d.length;c++)d[c].key=d[c].equId;return e.next=24,f({type:"querySuccess",payload:d,page:u});case 24:case"end":return e.stop()}},e,this)})},reducers:{clearData:function(e){return{data:[],paginationG:{},searchList:{},pageindex:1,pagesize:10,modalAdd:!1,selectedRowKeys:[]}},selectedRowKeys:function(e,t){return(0,u.default)({},e,{selectedRowKeys:t.payload})},modalAdd:function(e,t){return(0,u.default)({},e,{modalAdd:t.payload})},querySuccess:function(e,t){return(0,u.default)({},e,{data:t.payload,paginationG:t.page})},searchList:function(e,t){return(0,u.default)({},e,{searchList:t.payload})},setPage:function(e,t){return(0,u.default)({},e,{pageindex:t.payload,pagesize:t.size})}}},e.exports=t.default}});