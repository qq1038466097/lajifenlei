webpackJsonp([38],{836:function(a,e,t){"use strict";function n(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(e,"__esModule",{value:!0});var r=t(3),u=n(r),o=t(209),l=n(o),d=t(147),s=n(d);t(210);var c=t(319),p=t(60);t(89);e.default={namespace:"userEdit",state:{infos:null,data:[],roleData:[],funsData:[],funsIds:[],roleIds:[],showModal:!1,selectedRowKeys:[],checkCount:null,checkData:[],allData:[],typedata:[]},subscriptions:{setup:function(a){var e=a.dispatch;a.history.listen(function(a){if("/user/edit"===a.pathname){e({type:"clearData"});var t=(0,p.getQueryStringHash)("ids"),n={};n.employeeId=t,e({type:"queryInfo",payload:n});var r={};e({type:"queryRule",payload:r}),e({type:"queryFuns",payload:r}),e({type:"queryTypes",payload:r});var u={};u.employeeId=t,u.pageSize=0,u.employeeId=t,e({type:"queryDots",payload:u})}})}},effects:{queryDots:s.default.mark(function a(e,t){var n,r,u,o=e.payload,l=t.call,d=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l(c.myCheckPoint,o);case 2:if(n=a.sent,200!=n.code||null===n.data.data){a.next=8;break}for(r=n.data.data,u=0;u<r.length;u++)r[u].key=u;return a.next=8,d({type:"checkData",payload:r});case 8:case"end":return a.stop()}},a,this)}),queryTypes:s.default.mark(function a(e,t){var n,r=e.payload,u=t.call,o=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u(c.dotTypeList,r);case 2:if(n=a.sent,200!=n.code||null===n.data.data){a.next=6;break}return a.next=6,o({type:"typedata",payload:n.data.data});case 6:case"end":return a.stop()}},a,this)}),queryInfo:s.default.mark(function a(e,t){var n,r,u,o,l,d,p,f=e.payload,i=t.call,y=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i(c.orgUserInfo,f);case 2:if(n=a.sent,200!=n.code||null===n.data){a.next=16;break}return a.next=6,y({type:"infos",payload:n.data});case 6:for(r=n.data.funs,u=[],o=0;o<r.length;o++)u.push(r[o].funId);return a.next=11,y({type:"funsIds",payload:u});case 11:for(l=n.data.roles,d=[],p=0;p<l.length;p++)d.push(l[p].roleId);return a.next=16,y({type:"roleIds",payload:d});case 16:case"end":return a.stop()}},a,this)}),queryRule:s.default.mark(function a(e,t){var n,r=e.payload,u=t.call,o=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u(c.roleBindList,r);case 2:if(n=a.sent,200!=n.code||null===n.data.data){a.next=8;break}return a.next=6,o({type:"roleData",payload:n.data.data});case 6:a.next=10;break;case 8:return a.next=10,o({type:"roleData",payload:[]});case 10:case"end":return a.stop()}},a,this)}),queryFuns:s.default.mark(function a(e,t){var n,r=e.payload,u=t.call,o=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u(c.funList,r);case 2:if(n=a.sent,200!=n.code||null===n.data.data){a.next=6;break}return a.next=6,o({type:"funsData",payload:n.data.data});case 6:case"end":return a.stop()}},a,this)}),addRole:s.default.mark(function a(e,t){var n,r=e.payload,u=t.call;t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u(c.addUser,r);case 2:n=a.sent,200==n.code?(l.default.success("\u4fee\u6539\u6210\u529f\uff01"),setTimeout(function(){history.go(-1)},500)):l.default.error("\u4fee\u6539\u5931\u8d25\uff0c"+n.msg);case 4:case"end":return a.stop()}},a,this)}),hasAccount:s.default.mark(function a(e,t){var n,r=e.payload,u=e.datas,o=t.call,d=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o(c.isOnlyAccount,r);case 2:if(n=a.sent,200!=n.code||null!=n.data){a.next=8;break}return a.next=6,d({type:"addRole",payload:u});case 6:a.next=9;break;case 8:l.default.error("\u6539\u8d26\u53f7\u5df2\u7ecf\u5b58\u5728\uff0c\u8bf7\u4ece\u5f55\u5165\u65b0\u7684\u8d26\u53f7\uff01");case 9:case"end":return a.stop()}},a,this)}),queryData:s.default.mark(function a(e,t){var n,r,u,o,l,d,p=e.payload,f=t.call,i=t.put;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f(c.proLists,p);case 2:if(n=a.sent,200!=n.code||null===n.data.data){a.next=16;break}for(r={},r.total=n.data.totalCount,r.pageSize=n.data.pageSize,r.current=n.data.currentIndex,u=Math.ceil(n.data.totalCount/n.data.pageSize),r.pageCount=u,o=n.data.data,l=0;l<o.length;l++)o[l].key=l;return a.next=14,i({type:"allData",payload:o,page:r});case 14:a.next=23;break;case 16:return d={},d.total=0,d.pageSize=0,d.current=0,d.pageCount=0,a.next=23,i({type:"allData",payload:[],page:d});case 23:case"end":return a.stop()}},a,this)})},reducers:{clearData:function(a){return(0,u.default)({},a,{infos:null,data:[],roleData:[],funsData:[],funsIds:[],roleIds:[],showModal:!1,selectedRowKeys:[],checkCount:null,checkData:[],allData:[],typedata:[]})},roleIds:function(a,e){return(0,u.default)({},a,{roleIds:e.payload})},roleData:function(a,e){return(0,u.default)({},a,{roleData:e.payload})},funsIds:function(a,e){return(0,u.default)({},a,{funsIds:e.payload})},funsData:function(a,e){return(0,u.default)({},a,{funsData:e.payload})},infos:function(a,e){return(0,u.default)({},a,{infos:e.payload})},showModal:function(a,e){return(0,u.default)({},a,{showModal:e.payload})},selectedRowKeys:function(a,e){return(0,u.default)({},a,{selectedRowKeys:e.payload})},checkCount:function(a,e){return(0,u.default)({},a,{checkCount:e.payload})},checkData:function(a,e){return(0,u.default)({},a,{checkData:e.payload})},allData:function(a,e){return(0,u.default)({},a,{allData:e.payload})},typedata:function(a,e){return(0,u.default)({},a,{typedata:e.payload})}}},a.exports=e.default}});