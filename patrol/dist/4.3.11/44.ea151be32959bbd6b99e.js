webpackJsonp([44],{784:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),s=r(n),u=a(147),d=r(u),i=a(209),c=r(i),l=a(151),o=r(l);a(210);var p=a(319),f=a(60);t.default={namespace:"organization",state:{data:[],userData:[],ids:"",modalVisible:!1,pid:"",editForm:!1,orgName:"",orgId:"",orgPid:"",pagination:{},pageindex:1,pagesize:10,searchList:{},uId:"",roleId:"",buId:"",editOrg:!1,isChange:"",newStoreId:"",defalutKeys:["0-0"],history:null},subscriptions:{setup:function(e){var t=e.dispatch;e.history.listen(function(e){if("/organization"===e.pathname){var a=null,r=localStorage.getItem("orgSearchs"),n=null;null==r?(n={},t({type:"clearData"})):(n=JSON.parse(r),t({type:"history",payload:n}),t({type:"searchList",payload:n}),t({type:"querySuccess",payload:[]}),a=n.orgId),t({type:"queryRule",payload:{},orgs:f.orgs,_userSearch:n,isAdmin:f.isAdmin,myOrg:f.myOrg,_buId:a})}})}},effects:{queryRule:d.default.mark(function e(t,a){var r,n,s,u,i,l,f,y,g=t.payload,h=(t.orgs,t._userSearch),x=t.isAdmin,m=t.myOrg,b=t._buId,I=a.call,k=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(p.qeryQrg,g);case 2:if(r=e.sent,!r.data){e.next=39;break}if(0!=r.data.length){e.next=6;break}return e.abrupt("return",!1);case 6:if(n=r.data,s=(0,o.default)(h),u=[],null==x)for(n=m,i=0;i<n.length;i++)n[i].children=[],n[i].keys="0-"+i,0==i&&"{}"==s?(n[i].isActive=1,u.push(n[i].keys)):"{}"!==s&&null!==s&&h.orgId==_da.id?(n[i].isActive=1,u.push(n[i].keys)):n[i].isActive=0;else(l=function e(t,a){for(var r=0;r<t.length;r++){var n=t[r];n.keys=a+"-"+r,0==a&&"{}"==s?(n.isActive=1,u.push(n.keys)):"{}"!==s&&null!==s&&h.orgId==n.id?(n.isActive=1,u.push(n.keys)):n.isActive=0,n.children&&n.children.length>0&&e(t[r].children,n.keys)}})(n,0);return e.next=12,k({type:"defalutKeys",payload:u});case 12:return e.next=14,k({type:"querySuccess",payload:n});case 14:if(f=null,null!=b){e.next=23;break}return e.next=18,k({type:"buId",payload:n[0].id});case 18:return e.next=20,k({type:"setPid",payload:n[0].id});case 20:f=n[0].id,e.next=28;break;case 23:return e.next=25,k({type:"buId",payload:b});case 25:return e.next=27,k({type:"setPid",payload:b});case 27:f=b;case 28:if("{}"!=s){e.next=35;break}return y={},y.orgId=f,e.next=33,k({type:"getUsers",payload:y});case 33:e.next=37;break;case 35:return e.next=37,k({type:"getUsers",payload:h});case 37:e.next=40;break;case 39:c.default.error("\u8bf7\u6c42\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u5237\u65b0\u9875\u9762!");case 40:case"end":return e.stop()}},e,this)}),subOrg:d.default.mark(function e(t,a){var r,n,s=t.payload,u=t._userSearch,i=t.isAdmin,l=t.myOrg,o=t._buId,f=a.call,y=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(p.subOrg,s);case 2:if(r=e.sent,200!=r.code){e.next=10;break}return c.default.success("\u64cd\u4f5c\u6210\u529f!"),n={},e.next=8,y({type:"queryRule",payload:n,_userSearch:u,isAdmin:i,myOrg:l,_buId:o});case 8:e.next=11;break;case 10:c.default.error("\u64cd\u4f5c\u5931\u8d25\uff0c"+r.msg);case 11:case"end":return e.stop()}},e,this)}),delOrg:d.default.mark(function e(t,a){var r,n,s=t.payload,u=t._userSearch,i=t.isAdmin,l=t.myOrg,o=t._buId,f=a.call,y=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(p.delOrg,s);case 2:if(r=e.sent,200!=r.code){e.next=10;break}return c.default.success("\u64cd\u4f5c\u6210\u529f!"),n={},e.next=8,y({type:"queryRule",payload:n,_userSearch:u,isAdmin:i,myOrg:l,_buId:o});case 8:e.next=11;break;case 10:c.default.error("\u64cd\u4f5c\u5931\u8d25\uff0c"+r.msg);case 11:case"end":return e.stop()}},e,this)}),resetPwd:d.default.mark(function e(t,a){var r,n=t.payload,s=a.call;a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(p.resetPwds,n);case 2:r=e.sent,200==r.code?c.default.success("\u91cd\u7f6e\u5bc6\u7801\u6210\u529f!"):c.default.error("\u91cd\u7f6e\u5bc6\u7801\uff0c"+r.msg);case 4:case"end":return e.stop()}},e,this)}),delUser:d.default.mark(function e(t,a){var r,n,s=t.payload,u=a.call,i=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(p.delUser,s);case 2:if(r=e.sent,200!=r.code){e.next=10;break}return c.default.success("\u5220\u9664\u6210\u529f!"),n={},e.next=8,i({type:"getUsers",payload:n});case 8:e.next=11;break;case 10:c.default.error("\u5220\u9664\u5931\u8d25\uff0c"+r.msg);case 11:case"end":return e.stop()}},e,this)}),getUsers:d.default.mark(function e(t,a){var r,n,s,u,i=t.payload,l=a.call,o=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(p.getUser,i);case 2:if(r=e.sent,200!=r.code){e.next=15;break}return n=r.data,s={},s.total=n.totalCount,s.pageSize=n.pageSize,s.current=n.currentIndex,u=Math.ceil(n.totalCount/n.pageSize)||0,s.pageCount=u,e.next=13,o({type:"successUser",payload:n.data,page:s});case 13:e.next=16;break;case 15:c.default.error("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u8bd5\u8bd5\uff01");case 16:case"end":return e.stop()}},e,this)}),editUser:d.default.mark(function e(t,a){var r,n,s=t.payload,u=a.call,i=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(p.editUser,s);case 2:if(r=e.sent,!r.isSuccess){e.next=10;break}return c.default.success("\u64cd\u4f5c\u6210\u529f!"),n={},e.next=8,i({type:"getUsers",payload:n});case 8:e.next=11;break;case 10:c.default.error("\u64cd\u4f5c\u5931\u8d25\uff0c"+r.msg);case 11:case"end":return e.stop()}},e,this)}),editOrg:d.default.mark(function e(t,a){var r,n,s=t.payload,u=t._userSearch,i=t.isAdmin,l=t.myOrg,o=t._buId,f=a.call,y=a.put;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(p.editOrg,s);case 2:if(r=e.sent,200!=r.code){e.next=10;break}return c.default.success("\u64cd\u4f5c\u6210\u529f!"),n={},e.next=8,y({type:"queryRule",payload:n,_userSearch:u,isAdmin:i,myOrg:l,_buId:o});case 8:e.next=11;break;case 10:c.default.error("\u64cd\u4f5c\u5931\u8d25\uff0c"+r.msg);case 11:case"end":return e.stop()}},e,this)})},reducers:{clearData:function(e){return(0,s.default)({},e,{data:[],userData:[],ids:"",modalVisible:!1,pid:"",editForm:!1,orgName:"",orgId:"",orgPid:"",pagination:{},pageindex:1,pagesize:10,searchList:{},uId:"",roleId:"",buId:"",editOrg:!1,isChange:"",newStoreId:"",history:null})},setStoreId:function(e,t){return(0,s.default)({},e,{newStoreId:t.payload})},searchList:function(e,t){return(0,s.default)({},e,{searchList:t.payload})},setPage:function(e,t){return(0,s.default)({},e,{pageindex:t.payload,pagesize:t.size})},querySuccess:function(e,t){return(0,s.default)({},e,{data:t.payload})},uId:function(e,t){return(0,s.default)({},e,{uId:t.payload})},isChange:function(e,t){return(0,s.default)({},e,{isChange:t.payload})},roleId:function(e,t){return(0,s.default)({},e,{roleId:t.payload})},buId:function(e,t){return(0,s.default)({},e,{buId:t.payload})},seteditOrg:function(e,t){return(0,s.default)({},e,{editOrg:t.payload})},successUser:function(e,t){return(0,s.default)({},e,{userData:t.payload,pagination:t.page})},setModalVisible:function(e,t){return(0,s.default)({},e,{modalVisible:t.payload})},setData:function(e,t){return(0,s.default)({},e,{data:t.payload})},orgName:function(e,t){return(0,s.default)({},e,{orgName:t.payload})},orgPid:function(e,t){return(0,s.default)({},e,{orgPid:t.payload})},orgId:function(e,t){return(0,s.default)({},e,{orgId:t.payload})},editForm:function(e,t){return(0,s.default)({},e,{editForm:t.payload})},setPid:function(e,t){return(0,s.default)({},e,{pid:t.payload})},setIds:function(e,t){return(0,s.default)({},e,{ids:t.payload})},defalutKeys:function(e,t){return(0,s.default)({},e,{defalutKeys:t.payload})},history:function(e,t){return(0,s.default)({},e,{history:t.payload})}}},e.exports=t.default}});